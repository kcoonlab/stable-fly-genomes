cd ./Research/stablefly_wgs/working #or
cd /home/asommer3/Research/stablefly_wgs/working

#Add all of the raw sequences to a folder "Raw_Sequences_4939". Seqcoast names are as follows: "4939_107_S27_R1_001.fastq.gz"... but we need to change it to add the strain name at the beginning.


#### data>Raw_Sequences_4939 where XYZ is sample order. Creates sample list in the working folder directory
echo "Creating fastq_samples.txt file..."
ls ../data/raw_sequences/"$sample"*.fastq.gz | cut -f4 -d "/" | cut -d "_" -f1 | uniq | cut -d "_" -f1 > sample_list.txt
echo "DONE"


### Run Fastqc
conda activate fastqc
mkdir ../results/raw_fastqc_results
sh run_fastqc.sh      #run .py script for fastQ. Note these came pre-trimmed by the company but is the closest to raw I have
conda deactivate

### Run multiqc
conda activate multiqc
#mkdir ../results/multiqc
multiqc ../results/raw_fastqc_results -o ../results/multiqc
conda deactivate


###Shovill Genome Assembly
conda activate Shovill
#mkdir ./shovill_assemblies
#mkdir ../results/shovill_assemblies
#mkdir ../results/shovill_assembled_contigs
sh run_shovill.sh

#bash rename_shovill.sh
#find ../results/shovill_assemblies -name '*_contigs.fa' -exec cp {} ../results/shovill_assembled_contigs \;
conda deactivate


###Quast
#mkdir ../results/quast_reports
sh run_quast.sh
cat ../results/quast_reports/*/transposed_report.tsv > ../results/quast_reports/combined_transposed_report.tsv

###Busco
conda activate busco
mkdir ../results/busco_assembly_QC
mkdir ../results/busco_summaries

sh run_busco.sh
cp ../results/busco_assembly_QC/*/*.txt ../results/busco_summaries/
conda deactivate

###Prokka
conda activate prokka
mkdir ../results/prokka_annotations
sh run_prokka.sh
conda deactivate

mkdir ../data/ProkkaGFF
find ../results/prokka_annotations -name '*.gff' -exec cp {} ../data/ProkkaGFF \;

mkdir ../data/contigs_organized
find ../results/shovill_assembled_contigs -name '*.fa' -exec mv {} ../data/contigs_organized \;


#######Need to make sure biotech center sequence reads were analyzed with the same quast version######
mkdir ../results/BiotechContigs #Then added the 106 genomes from the biotech center here. Ran Quast again to ensure the same version was used


cd ../results/BiotechContigs
for file in AS*; do
  mv "$file" "${file/AS/AS0}"
done
cd ../../working
#Then I moved all the contigs to the contigs_organized folder and deleted the folder

cd ../data/trimmed_sequences_bt
for file in AS*; do
  mv "$file" "${file/AS/AS0}"
done
cd ../../working

mkdir ../results/quast_reports_bt
sh run_quast_bt.sh
cat ../results/quast_reports_bt/*/transposed_report.tsv > ../results/quast_reports_bt/combined_transposed_report.tsv
#rm -rf ../data/trimmed_sequences_bt/*
#Then I added in the 106 contigs from the Biotech center, and organized all them by taxa


### ClermonTyping for e coli phylogroups
mkdir ../analysis
mkdir ../analysis/ClermonTyping
cd ../analysis/ClermonTyping
chmod +x ClermonTyping/clermonTyping.sh
chmod +x ./ClermonTyping/bin/clermont.py
chmod +x ./ClermonTyping/bin/mash
#fastafilepath is a list to all the fasta files
./ClermonTyping/clermonTyping.sh --fastafile fastafilepath.txt
find ./analysis_2024-06-06_113430 -type f -name "*.fa" -exec rm {} +
find ./analysis_2024-06-06_113430 -type f -name "*.fa.xml" -exec rm {} +

### Kleborate for Kleb pneuom
cd
cd ./Research/stablefly_wgs/working
mkdir ../analysis/kleborate
kleborate --all -o ../analysis/kleborate/results.txt -a ../data/contigs_organized/Klebsiella_P/*.fa


###MLST

###ARG and VF analysis
cd ./Research/stablefly_wgs/working
mkdir ../analysis/mlst
conda activate mlst

mlst --longlist

msciuri
klebsiella
ecoli

mlst --scheme msciuri ../data/contigs_organized/Staph/Mammaliicoccus/*.fa > ../analysis/mlst/msciuri_mlst.csv
mlst --scheme klebsiella ../data/contigs_organized/Klebsiella_P/*.fa > ../analysis/mlst/klebsiella_mlst.csv
mlst --scheme ecoli ../data/contigs_organized/Escherichia/*.fa > ../analysis/mlst/ecoli_mlst.csv
conda deactivate


###ARG and VF analysis

conda activate abricate

#E coli VFs with ecoli_vf and vfdb
cd ./Research/stablefly_wgs/working
mkdir ../analysis/VFs

#ecoli_vf
mkdir ../analysis/VFs/Escherichia
abricate --db ecoli_vf ../data/contigs_organized/Escherichia/*.fa > ../analysis/VFs/Escherichia/Escherichia_ecoli_vf_results.tab
abricate --summary ../analysis/VFs/Escherichia/Escherichia_ecoli_vf_results.tab > ../analysis/VFs/Escherichia/Escherichia_ecoli_vf_summary.tab

#vfdb for e. coli
abricate --db vfdb ../data/contigs_organized/Escherichia/*.fa > ../analysis/VFs/Escherichia/Escherichia_vfdb_results.tab
abricate --summary ../analysis/VFs/Escherichia/Escherichia_vfdb_results.tab > ../analysis/VFs/Escherichia/Escherichia_vfdb_summary.tab

#VirulenceFinder (E.coli sequences) for E. coli
abricate --db virulencefinder ../data/contigs_organized/Escherichia/*.fa > ../analysis/VFs/Escherichia/Escherichia_virulencefinder_results.tab
abricate --summary ../analysis/VFs/Escherichia/Escherichia_virulencefinder_results.tab > ../analysis/VFs/Escherichia/Escherichia_virulencefinder_summary.tab

#vfdb for KPI
mkdir ../analysis/VFs/Klebsiella
abricate --db vfdb ../data/contigs_organized/Klebsiella_P/*.fa > ../analysis/VFs/Klebsiella/Klebsiella_vfdb_results.tab
abricate --summary ../analysis/VFs/Klebsiella/Klebsiella_vfdb_results.tab > ../analysis/VFs/Klebsiella/Klebsiella_vfdb_summary.tab

#vfdb for staph
mkdir ../analysis/VFs/Staph
abricate --db vfdb $(find ../data/contigs_organized/Staph -name '*.fa') > ../analysis/VFs/Staph/Staph_vfdb_results.tab
abricate --summary ../analysis/VFs/Staph/Staph_vfdb_results.tab > ../analysis/VFs/Staph/Staph_vfdb_summary.tab

#vfdb for all
mkdir ../analysis/VFs/All
abricate --db vfdb ../results/shovill_assembled_contigs/*.fa > ../analysis/VFs/All/All_vfdb_results.tab
abricate --summary ../analysis/VFs/All/All_vfdb_results.tab > ../analysis/VFs/All/All_vfdb_summary.tab

#Resfinder
mkdir ../analysis/Resfinder

mkdir ../analysis/Resfinder/Escherichia
abricate --db resfinder ../data/contigs_organized/Escherichia/*.fa > ../analysis/Resfinder/Escherichia/Escherichia_Resfinder_results.tab
abricate --summary ../analysis/Resfinder/Escherichia/Escherichia_Resfinder_results.tab > ../analysis/Resfinder/Escherichia/Escherichia_Resfinder_summary.tab


mkdir ../analysis/Resfinder/Klebsiella
abricate --db resfinder ../data/contigs_organized/Klebsiella_P/*.fa > ../analysis/Resfinder/Klebsiella/Klebsiella_Resfinder_results.tab
abricate --summary ../analysis/Resfinder/Klebsiella/Klebsiella_Resfinder_results.tab > ../analysis/Resfinder/Klebsiella/Klebsiella_Resfinder_summary.tab

mkdir ../analysis/Resfinder/Staph
abricate --db resfinder $(find ../data/contigs_organized/Staph -name '*.fa') > ../analysis/Resfinder/Staph/Staph_Resfinder_results.tab
abricate --summary ../analysis/Resfinder/Staph/Staph_Resfinder_results.tab > ../analysis/Resfinder/Staph/Staph_Resfinder_summary.tab

mkdir ../analysis/Resfinder/All
abricate --db resfinder ../results/shovill_assembled_contigs/*.fa > ../analysis/Resfinder/All/All_Resfinder_results.tab
abricate --summary ../analysis/Resfinder/All/All_Resfinder_results.tab > ../analysis/Resfinder/All/All_Resfinder_summary.tab

#Other
mkdir ../analysis/Resfinder/OtherARG
abricate --db card ../data/contigs_organized/Escherichia/*.fa > ../analysis/Resfinder/OtherARG/Escherichia_CARD_results.tab
abricate --summary ../analysis/Resfinder/OtherARG/Escherichia_CARD_results.tab > ../analysis/Resfinder/OtherARG/Escherichia_CARD_summary.tab

abricate --db ncbi ../data/contigs_organized/Escherichia/*.fa > ../analysis/Resfinder/OtherARG/Escherichia_ncbi_results.tab
abricate --summary ../analysis/Resfinder/OtherARG/Escherichia_ncbi_results.tab > ../analysis/Resfinder/OtherARG/Escherichia_ncbi_summary.tab


#PlasmidFinder
mkdir ../analysis/PlasmidFinder
conda activate abricate

abricate --db plasmidfinder ../data/contigs_organized/Escherichia/*.fa > ../analysis/PlasmidFinder/Escherichia_plasmidfinder_results.tab
abricate --summary ../analysis/PlasmidFinder/Escherichia_plasmidfinder_results.tab > ../analysis/PlasmidFinder/Escherichia_PlasmidFinder_summary.tab

abricate --db plasmidfinder ../data/contigs_organized/Klebsiella_P/*.fa > ../analysis/PlasmidFinder/Klebsiella_P_plasmidfinder_results.tab
abricate --summary ../analysis/PlasmidFinder/Klebsiella_P_plasmidfinder_results.tab > ../analysis/PlasmidFinder/Klebsiella_P_PlasmidFinder_summary.tab

abricate --db plasmidfinder ../data/contigs_organized/Acinetobacter/*.fa > ../analysis/PlasmidFinder/Acinetobacter_plasmidfinder_results.tab #0 hits
abricate --db plasmidfinder ../data/contigs_organized/Bacillus/*.fa > ../analysis/PlasmidFinder/Bacillus_plasmidfinder_results.tab #0 hits


abricate --db plasmidfinder ../data/contigs_organized/Enterobacter/*.fa > ../analysis/PlasmidFinder/Enterobacter_plasmidfinder_results.tab
abricate --summary ../analysis/PlasmidFinder/Enterobacter_plasmidfinder_results.tab > ../analysis/PlasmidFinder/Enterobacter_PlasmidFinder_summary.tab

abricate --db plasmidfinder ../data/contigs organized/Other_Enteros/*.fa > ../analysis/PlasmidFinder/Other_Enteros_plasmidfinder_results.tab
abricate --summary ../analysis/PlasmidFinder/Other_Enteros_plasmidfinder_results.tab > ../analysis/PlasmidFinder/Other_Enteros_PlasmidFinder_summary.tab

find ../data/contigs_organized/Staph -name '*.fa' -print0 | xargs -0 abricate --db plasmidfinder > ../analysis/PlasmidFinder/Staph_plasmidfinder_results.tab
abricate --summary ../analysis/PlasmidFinder/Staph_plasmidfinder_results.tab > ../analysis/PlasmidFinder/Staph_PlasmidFinder_summary.tab


###Panaroo
cd ./Research/stablefly_wgs/working
mkdir ../analysis/panaroo

#Escherichia
mkdir ../analysis/panaroo/Escherichia
panaroo -i ../data/GFF_organized/Escherichia/*.gff -o ../analysis/panaroo/Escherichia --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#Klebsiella
#filtered alignement kept 3732 out of 4070 genes
mkdir ../analysis/panaroo/Klebsiella
panaroo -i ../data/GFF_organized/Klebsiella/*.gff -o ../analysis/panaroo/Klebsiella --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#Mammaliicoccus (all)
#filtered alignement kept 935 out of 947 genes
mkdir ../analysis/panaroo/Mammaliicoccus
panaroo -i ../data/GFF_organized/Mammaliicoccus/*.gff -o ../analysis/panaroo/Mammaliicoccus --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#Mammaliicoccus sciuri (removed the non sciuri from ../data/GFF_organized/Mammaliicoccus)
#2083.0 out of 2194 genes kept in filtered core genome
mkdir ../analysis/panaroo/Mammaliicoccus_S
panaroo -i ../data/GFF_organized/Mammaliicoccus/*.gff -o ../analysis/panaroo/Mammaliicoccus_S --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#Staph Xylosus Group (including Xylosus, shinii, pseudoxylosus)
#filtered alignment kept 2176 out of 2255 genes
mkdir ../analysis/panaroo/StaphXylosusGroup
panaroo -i ../data/GFF_organized/Staph/XylosusGroup/*.gff -o ../analysis/panaroo/StaphXylosusGroup --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

###Fasttree
#Analysis on Server

#Escherichia Tree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis
mkdir ./WGS_Analysis/EscherichiaTree
cd ../../media/GS_Data_6/Sommer/WGS_Analysis/EscherichiaTree
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > EC_core_gene_tree.newick


#Klebsiella Tree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/KlebsiellaTree
cd ./WGS_Analysis/KlebsiellaTree
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > KP_core_gene_tree.newick

#Mammaliicoccus Tree all
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/MammaliicoccusTree
cd ./WGS_Analysis/MammaliicoccusTree
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > Mammaliicoccus_core_gene_tree.newick

#Mammaliicoccus sciuri
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/Mammaliicoccus_S_Tree
cd ./WGS_Analysis/Mammaliicoccus_S_Tree
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > Mammaliicoccussciuri_core_gene_tree.newick

#Xylosus Group
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/XylosusGroupTree
cd ./WGS_Analysis/XylosusGroupTree
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > XylosusGroupTree_core_gene_tree.newick

###Scoary
cd ./Research/stablefly_wgs/working
mkdir ../analysis/scoary

#EC
cd ./Research/stablefly_wgs/working
mkdir ../analysis/scoary/myEC
scoary -g ../analysis/panaroo/Escherichia/gene_presence_absence_roary2.csv -t ../analysis/scoary/myEC/Hostgroup_membership.csv -o ../analysis/scoary/myEC -p 1E-5 -c BH --no_pairwise
#note that I removed AS358 from gene_presence_absence_roary as it was the only WVDL

#KP
cd ./Research/stablefly_wgs/working
mkdir ../analysis/scoary/myKP
scoary -g ../analysis/panaroo/Klebsiella/gene_presence_absence_roary.csv -t ../analysis/scoary/myKP/Hostgroup_membership.csv -o ../analysis/scoary/myKP -p 1E-5 -c BH --no_pairwise
scoary -g ../analysis/panaroo/Klebsiella/gene_presence_absence_roary.csv -t ../analysis/scoary/myKP/Hostgroup_membership_2.csv -o ../analysis/scoary/myKP -p 1E-5 -c BH --no_pairwise

###Eggnog mapper
#find ../results/prokka_annotations -name '*.faa' -exec cp {} ../data/faa \;

cd ./Research/stablefly_wgs/working
mkdir ../data/faa
cd ./emapper
mkdir ../../analysis/eggnog/Escherichia
mkdir ../../analysis/eggnog/Klebsiella
mkdir ../../analysis/eggnog/Mammaliicoccus
mkdir ../../analysis/eggnog/xylosus
mkdir ../../analysis/eggnog/arlettae
mkdir ../../analysis/eggnog/gallinarum
mkdir ../../analysis/eggnog/other
mkdir ../../analysis/eggnog/pseudoxylosus
mkdir ../../analysis/eggnog/saprophyticus
mkdir ../../analysis/eggnog/shinii

export EGGNOG_DATA_DIR=/home/asommer3/eggnog-mapper-data
sh run_emapper_EC.sh
sh run_emapper_KP.sh
sh run_emapper_Mammaliicoccus.sh
sh run_emapper_xylosus.sh
sh run_emapper_arlettae.sh
sh run_emapper_gallinarum.sh
sh run_emapper_other.sh
sh run_emapper_pseudoxylosus.sh
sh run_emapper_saprophyticus.sh
sh run_emapper_shinii.sh


###xylosus NCBI
conda activate ncbi_datasets
cd ./Research/stablefly_wgs/working
mkdir ../analysis/ncbi
mkdir ../analysis/ncbi/xylosus #then added a file list of ncbi genomes to download

cd ../analysis/ncbi/xylosus
datasets download genome accession --inputfile xylosus_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm # checkm taxon_list
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/checkm
checkm taxonomy_wf genus Staphylococcus -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/checkm/checkm.tsv
#Delete other output files than the summary due to Space. Remove low quality assemblies
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/xylosus/drep_highlyrelated
mkdir ../analysis/ncbi/xylosus/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/xylosus/drep_strain

dRep compare ../analysis/ncbi/xylosus/drep_highlyrelated -g ../analysis/ncbi/xylosus/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/xylosus/drep_highlyrelatedconserved -g ../analysis/ncbi/xylosus/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/xylosus/drep_strain -g ../analysis/ncbi/xylosus/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999

conda activate prokka
mkdir ../analysis/ncbi/xylosus/prokka_annotations
mkdir ../analysis/ncbi/xylosus/prokka_annotations/output
#input dir is ../analysis/ncbi/xylosus/ncbi_dataset/fna
#output dir is ../analysis/ncbi/xylosus/prokka_annotations/output
input_dir="../analysis/ncbi/xylosus/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 2136 of 2263 genes for filtered alignment

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryA
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryB
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryC
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryD
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced


scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo/gene_presence_absence_roary.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryA/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryA -p 1E-5 -c BH --no_pairwise

scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo/gene_presence_absence_roary.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryB/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryB -p 1E-5 -c BH --no_pairwise

scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo/gene_presence_absence_roary.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryC/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryC -p 1E-5 -c BH --no_pairwise

scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/panaroo/gene_presence_absence_roary.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryD/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryD -p 1E-5 -c BH --no_pairwise

scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced/gene_presence_absence_reduced.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced -p 1E-5 -c BH --no_pairwise

scoary -g /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced/gene_presence_absence_reduced.csv -t /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced/Hostgroup_membership.csv -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/scoary/scoaryreduced -p 0.05 -c BH --no_pairwise


#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/Xylosus_NCBI
cd ./WGS_Analysis/Xylosus_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > XylosusNCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit

###Shinii NCBI
conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/shinii

cd ../analysis/ncbi/shinii #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile shinii_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/checkm
checkm taxonomy_wf genus Staphylococcus -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/checkm/checkm.tsv
#Delete other output files than the summary due to Space
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/shinii/drep_highlyrelated
mkdir ../analysis/ncbi/shinii/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/shinii/drep_strain
dRep compare ../analysis/ncbi/shinii/drep_highlyrelated -g ../analysis/ncbi/shinii/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/shinii/drep_highlyrelatedconserved -g ../analysis/ncbi/shinii/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/shinii/drep_strain -g ../analysis/ncbi/shinii/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999


conda activate prokka
mkdir ../analysis/ncbi/shinii/prokka_annotations
mkdir ../analysis/ncbi/shinii/prokka_annotations/output
input_dir="../analysis/ncbi/shinii/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;


mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/shinii/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 1916 of 2243 genes for filtered alignment

#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/shinii_NCBI
cd ./WGS_Analysis/shinii_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > shiniiNCBI_core_gene_tree.newick

###arlettae NCBI
conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/arlettae

cd ../analysis/ncbi/arlettae #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile arlettae_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/checkm
checkm taxonomy_wf genus Staphylococcus -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/checkm/checkm.tsv
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/arlettae/drep_highlyrelated
mkdir ../analysis/ncbi/arlettae/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/arlettae/drep_strain
dRep compare ../analysis/ncbi/arlettae/drep_highlyrelated -g ../analysis/ncbi/arlettae/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/arlettae/drep_highlyrelatedconserved -g ../analysis/ncbi/arlettae/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/arlettae/drep_strain -g ../analysis/ncbi/arlettae/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999


conda activate prokka
mkdir ../analysis/ncbi/arlettae/prokka_annotations
mkdir ../analysis/ncbi/arlettae/prokka_annotations/output
input_dir="../analysis/ncbi/arlettae/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/arlettae/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 1589 of 1707 genes for filtered alignment

#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/arlettae_NCBI
cd ./WGS_Analysis/arlettae_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > arlettaeNCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit




###gallinarum NCBI
conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/gallinarum

cd ../analysis/ncbi/gallinarum #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile gallinarum_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/checkm
checkm taxonomy_wf genus Staphylococcus -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/checkm/checkm.tsv
conda deactivate


cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/gallinarum/drep_highlyrelated
mkdir ../analysis/ncbi/gallinarum/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/gallinarum/drep_strain
dRep compare ../analysis/ncbi/gallinarum/drep_highlyrelated -g ../analysis/ncbi/gallinarum/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/gallinarum/drep_highlyrelatedconserved -g ../analysis/ncbi/gallinarum/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/gallinarum/drep_strain -g ../analysis/ncbi/gallinarum/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999

conda activate prokka
mkdir ../analysis/ncbi/gallinarum/prokka_annotations
mkdir ../analysis/ncbi/gallinarum/prokka_annotations/output
input_dir="../analysis/ncbi/gallinarum/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;


mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/gallinarum/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 2055 of 2255 genes for filtered alignment


#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/gallinarum_NCBI
cd ./WGS_Analysis/gallinarum_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > gallinarumNCBI_core_gene_tree.newick



###pseudoxylosus NCBI
conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/pseudoxylosus

cd ../analysis/ncbi/pseudoxylosus #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile pseudoxylosus_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/checkm
checkm taxonomy_wf genus Staphylococcus -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/checkm/checkm.tsv
conda deactivate


cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/pseudoxylosus/drep_highlyrelated
mkdir ../analysis/ncbi/pseudoxylosus/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/pseudoxylosus/drep_strain
dRep compare ../analysis/ncbi/pseudoxylosus/drep_highlyrelated -g ../analysis/ncbi/pseudoxylosus/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/pseudoxylosus/drep_highlyrelatedconserved -g ../analysis/ncbi/pseudoxylosus/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/pseudoxylosus/drep_strain -g ../analysis/ncbi/pseudoxylosus/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999

conda activate prokka
mkdir ../analysis/ncbi/pseudoxylosus/prokka_annotations
mkdir ../analysis/ncbi/pseudoxylosus/prokka_annotations/output
input_dir="../analysis/ncbi/pseudoxylosus/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/pseudoxylosus/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 1797 of 1936 genes for filtered alignment

#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/pseudoxylosus_NCBI
cd ./WGS_Analysis/pseudoxylosus_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > pseudoxylosusNCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit


###sciuri NCBI
conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/sciuri

cd ../analysis/ncbi/sciuri #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile sciuri_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/checkm
checkm taxonomy_wf family Staphylococcaceae -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/checkm/checkm.tsv
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/sciuri/drep_highlyrelated
mkdir ../analysis/ncbi/sciuri/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/sciuri/drep_strain
dRep compare ../analysis/ncbi/sciuri/drep_highlyrelated -g ../analysis/ncbi/sciuri/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/sciuri/drep_highlyrelatedconserved -g ../analysis/ncbi/sciuri/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/sciuri/drep_strain -g ../analysis/ncbi/sciuri/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999


conda activate prokka
mkdir ../analysis/ncbi/sciuri/prokka_annotations
mkdir ../analysis/ncbi/sciuri/prokka_annotations/output
input_dir="../analysis/ncbi/sciuri/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;


mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8
#kept 2037 of 2131 genes for filtered alignment


#Analysis on Server
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/sciuri_NCBI
cd ./WGS_Analysis/sciuri_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > sciuri_NCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit



###Kleb NCBI

conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/KP1

cd ../analysis/ncbi/KP1 #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile KP1_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/checkm
checkm taxonomy_wf genus Klebsiella -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/checkm/checkm.tsv
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/KP1/drep_highlyrelated
mkdir ../analysis/ncbi/KP1/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/KP1/drep_strain
dRep compare ../analysis/ncbi/KP1/drep_highlyrelated -g ../analysis/ncbi/KP1/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/KP1/drep_highlyrelatedconserved -g ../analysis/ncbi/KP1/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/KP1/drep_strain -g ../analysis/ncbi/KP1/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999


conda activate prokka
mkdir ../analysis/ncbi/KP1/prokka_annotations
mkdir ../analysis/ncbi/KP1/prokka_annotations/output
input_dir="../analysis/ncbi/KP1/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;


mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/KP1/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#kept 3664 of 3931 genes for filtered alignment


#Analysis on Server#cd
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/KP1_NCBI
cd ./WGS_Analysis/KP1_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > KP1_NCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit



###Ecoli NCBI

conda activate ncbi_datasets
cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/Ecoli

cd ../analysis/ncbi/Ecoli #then added a file list of ncbi genomes to download

datasets download genome accession --inputfile Ecoli_GCA.txt --include genome
unzip ncbi_dataset.zip
rm ncbi_dataset.zip
conda deactivate

cd ./ncbi_dataset
mkdir fna; for f in data/*/*.fna; do
   out=$( echo $f | cut -f2 -d'/');
   mv $f fna/${out}.fna;
done

conda activate checkm
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/checkm
checkm taxonomy_wf genus Escherichia -t 8 -x fna /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/ncbi_dataset/fna  /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/checkm --file /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/checkm/checkm.tsv
conda deactivate

cd /home/asommer3/Research/stablefly_wgs/working
mkdir ../analysis/ncbi/Ecoli/drep_highlyrelated
mkdir ../analysis/ncbi/Ecoli/drep_highlyrelatedconserved
mkdir ../analysis/ncbi/Ecoli/drep_strain
dRep compare ../analysis/ncbi/Ecoli/drep_highlyrelated -g ../analysis/ncbi/Ecoli/ncbi_dataset/fna/*.fna --P_ani .998  --S_ani .998
dRep compare ../analysis/ncbi/Ecoli/drep_highlyrelatedconserved -g ../analysis/ncbi/Ecoli/ncbi_dataset/fna/*.fna --P_ani .999  --S_ani .999
dRep compare ../analysis/ncbi/Ecoli/drep_strain -g ../analysis/ncbi/Ecoli/ncbi_dataset/fna/*.fna --P_ani .9999  --S_ani .9999


conda activate prokka
mkdir ../analysis/ncbi/Ecoli/prokka_annotations
mkdir ../analysis/ncbi/Ecoli/prokka_annotations/output
input_dir="../analysis/ncbi/Ecoli/ncbi_dataset/fna"; output_dir="/home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/prokka_annotations/output"; cd "$input_dir"; for file in *.fna; do tag=${file%.fna}; prokka --prefix "$tag" --locustag "$tag" --outdir "$output_dir/2017-06-12_${tag}_prokka" --force --addgenes --gcode 11 "$file"; done
conda deactivate

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/prokka_annotations/gff_prokka
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/prokka_annotations/output
find . -name '*.gff' -exec cp {} ../gff_prokka \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/panaroo
cd /home/asommer3/Research/stablefly_wgs/working
panaroo -i /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/prokka_annotations/gff_prokka/*.gff -o /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/panaroo --clean-mode strict -a core --aligner mafft --core_threshold 0.98 -t 8

#kept 3019 of 3168 genes for filtered alignment


#Analysis on Server#cd
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
mkdir ./WGS_Analysis/Ecoli_NCBI
cd ./WGS_Analysis/Ecoli_NCBI
/home/suenlab/Software/FastTree -nt -log logfile.txt  core_gene_alignment_filtered.aln > Ecoli_NCBI_core_gene_tree.newick
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit

######EGGNOG NCBI

###Eggnog mapper
#find ../results/prokka_annotations -name '*.faa' -exec cp {} ../data/faa \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/faa
#find /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations -name '*.faa' -exec cp {} /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/prokka_annotations/faa \;

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/emapper
cd /home/asommer3/Research/stablefly_wgs/working/emapper
export EGGNOG_DATA_DIR=/home/asommer3/eggnog-mapper-data

sh run_emapper_NCBI_sciuri.sh



#xylosus
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/faa

#find /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations -name '*.faa' -exec cp {} /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/prokka_annotations/faa \;
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/xylosus/emapper
cd /home/asommer3/Research/stablefly_wgs/working/emapper

export EGGNOG_DATA_DIR=/home/asommer3/eggnog-mapper-data

sh run_emapper_NCBI_xylosus.sh



####Clermon typing
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/ClermonTyping
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/ClermonTyping
ls /home/asommer3/Research/stablefly_wgs/analysis/ncbi/Ecoli/ncbi_dataset/fna/*.fna > NCBI_Ecoli_files.txt

#location of the clermontyping script /home/asommer3/Research/stablefly_wgs/analysis/ClermonTyping/clermonTyping.sh
/home/asommer3/Research/stablefly_wgs/analysis/ClermonTyping/ClermonTyping/clermonTyping.sh --fastafile NCBI_Ecoli_files.txt

#replate the analysis_2024-08-05_105208 with output file
find ./analysis_2024-08-05_105208 -type f -name "*.fna" -exec rm {} +
find ./analysis_2024-08-05_105208 -type f -name "*.fna.xml" -exec rm {} +


###########
mkdir /home/asommer3/Research/stablefly_wgs/analysis/Kaptiv
conda activate kaptive
kaptive assembly kpsc_k /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Klebsiella_P/*.fa \
 -o /home/asommer3/Research/stablefly_wgs/analysis/Kaptive/kaptive_results.tsv -f /home/asommer3/Research/stablefly_wgs/analysis/Kaptive/ -V  


mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/MLST_tree
mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/MLST_tree/gene_alignments

#Moved the following alignments produced via panaroo to the gene_alignments folder: ackA, aroE, ftsZ, glpK, gmk, pta1 (pta_1~~~pta_2.aln), tpiA
#Those alignments were produced through Panaroo

cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/MLST_tree/gene_alignments
python concac_mlst_sciuri.py #produces file concatenated_alignments_sciuri_MLST
 

mkdir /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/MLST_tree/raxml
cd /home/asommer3/Research/stablefly_wgs/analysis/ncbi/sciuri/MLST_tree/raxml

#generate 100 ML trees on distinct starting trees and also print the tree with the best likelihood
raxmlHPC-PTHREADS -T 6 -m GTRGAMMA -p 12345 -# 100 -s ../gene_alignments/concatenated_alignments_sciuri_MLST.fas  -n Stage1
#Perform 100 bootstraps on alignment
raxmlHPC-PTHREADS -m GTRGAMMA -p 12345 -b 12345 -# 100 -s ../concatenated_alignments_sciuri_MLST -n Stage2
#draw bipartitions on the best ML tree
raxmlHPC-PTHREADS -m GTRCAT -p 12345 -f b -t RAxML_bestTree.Stage1 -z RAxML_bootstrap.Stage2 -n Stage3

###Fasttree
#cd
#cd ./Software
#wget http://www.microbesonline.org/fasttree/FastTree -O FastTree
#chmod +x FastTree

/home/suenlab/Software/FastTree -h #From anywhere on server


#Start a Screen
screen -ls
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree
#screen -r Sommer_fasttree #to reattach
### screen -S Sommer_fasttree  -X quit  #to quit


# Tree
cd
cd ../../media/GS_Data_6/Sommer #Access to my files
cd ./WGS_Analysis/sciuri_NCBI/MLST_Tree
/home/suenlab/Software/FastTree -nt -log logfile.txt  MLST_sciuri_sequence.aln > MLST_sciuri_fastree.newick
#Total time: 23.22 seconds Unique: 222/281 Bad splits: 0/219ernal splits


mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus


####Mummer4 Install

wget https://github.com/mummer4/mummer/releases/download/v4.0.0rc1/mummer-4.0.0rc1.tar.gz
tar -xzvf mummer-4.0.0rc1.tar.gz
cd mummer-4.0.0rc1
./configure
make
make install


/home/asommer3/mummer-4.0.0rc1/nucmer --version
export PATH=$PATH:/home/asommer3/mummer-4.0.0rc1
source ~/.bashrc

export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH
echo "export LD_LIBRARY_PATH=/usr/local/lib:$LD_LIBRARY_PATH" >> ~/.bashrc
source ~/.bashrc
nucmer --version


###KP
#AS0363_vs_AS0560
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Klebsiella_P/AS0363_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Klebsiella_P/AS0560_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.filtered.delta


dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/KP/AS0363_vs_AS0560/AS0363_vs_AS0560.delta






###arlettae

#AS0200_vs_AS0572
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0200_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0572_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0200_vs_AS0572/AS0200_vs_AS0572.delta


#AS0882_vs_AS0572
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0882_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0572_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0882_vs_AS0572/AS0882_vs_AS0572.delta


#AS0739_vs_AS0572
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0739_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/arlettae/AS0572_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/arlettae/AS0739_vs_AS0572/AS0739_vs_AS0572.delta



###xylosus

#AS1331_vs_AS0569
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS1331_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS0569_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1331_vs_AS0569/AS1331_vs_AS0569.delta


#AS1347_vs_AS0569
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS1347_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS0569_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1347_vs_AS0569/AS1347_vs_AS0569.delta


#AS1293_vs_AS0569
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS1293_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/xylosus/AS0569_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/xylosus/AS1293_vs_AS0569/AS1293_vs_AS0569.delta



###sciuri

#AS0296_vs_AS0565
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0296_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0565_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.filtered.delta


dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta


mummerplot --filter --layout --png --no-gridlines --no-x-axis --no-y-axis  \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0296_vs_AS0565/AS0296_vs_AS0565.delta





#AS0650_vs_AS1395
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0650_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS1395_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.filtered.delta


dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0650_vs_AS1395/AS0650_vs_AS1395.delta



#AS0913_vs_AS0579
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0913_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0579_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.filtered.delta


dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS0913_vs_AS0579/AS0913_vs_AS0579.delta

#AS1298_vs_AS0567
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS1298_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/Mammaliicoccus/sciuri/AS0567_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567.filtered.delta


dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/sciuri/AS1298_vs_AS0567/AS1298_vs_AS0567.delta



###gallinarum

#AS0915_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0915_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0564/AS0915_vs_AS0564.delta

#AS0915_vs_AS0571
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0915_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0571_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0915_vs_AS0571/AS0915_vs_AS0571.delta

#AS1336_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS1336_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1336_vs_AS0564/AS1336_vs_AS0564.delta

#AS1286_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS1286_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1286_vs_AS0564/AS1286_vs_AS0564.delta

#AS0303_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0303_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS0303_vs_AS0564/AS0303_vs_AS0564.delta

#AS1328_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS1328_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1328_vs_AS0564/AS1328_vs_AS0564.delta

#AS1356_vs_AS0564
mkdir /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564
nucmer -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564 \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS1356_contigs.fa \
  /home/asommer3/Research/stablefly_wgs/data/contigs_organized/Staph/gallinarum/AS0564_contigs.fa
show-coords -r -c -l \
  /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.delta \
  > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564_raw.coords

delta-filter -r -q /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.delta > /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.filtered.delta

dnadiff  \
  -p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564_dnadiff \
  -d /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.delta

mummerplot --filter --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564_filtered \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.delta

mummerplot --layout --png \
-p /home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564 \
/home/asommer3/Research/stablefly_wgs/analysis/MummerComparison/gallinarum/AS1356_vs_AS0564/AS1356_vs_AS0564.delta


#Install Mobmess
conda create -n mobmess
conda activate mobmess
conda install --name mobmess -y -c anaconda -c conda-forge -c bioconda --override-channels --strict-channel-priority  numpy pandas scipy scikit-learn igraph numba python-blosc mummer4
pip install ./PlasX
pip install ./MobMess
conda install -y seaborn
conda install -y -c conda-forge pypdf2 wkhtmltopdf
conda install -y jinja2
pip install pdfkit
#/home/asommer3/miniconda3/envs/mobmess/lib/python3.12/site-packages/mobmess/ani_utils.py
#replace replaced "np.int" with "int" (Whole word)





########LnuA Plasmids#######

#plasmid database was from 11-03-2023
#I want to start by trying all three small lnuA plasmids together: 13_4, 13_7, and 21_19
#Using references AM399082.1, AM399081.1

mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mobmess
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mars
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/plasmidfinder





#Added lnuA_replicons_preformatted.fasta to input subfolder. The fasta file has all rep proteins on (+) strand


cd /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input
awk '/^>/ {if (NR>1) print ""; print $0; next} {printf "%s", $0} END {print ""}' lnuA_replicons_preformatted.fasta > lnuA_replicons_formatted.fasta 

conda activate abricate #abricate to doublecheck rep genes
abricate --db plasmidfinder /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input/lnuA_replicons_formatted.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/plasmidfinder/lnuA_plasmidfinder_results.tab
conda deactivate


####python####
python
input_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input/lnuA_replicons_formatted.fasta'
output_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mobmess/completeinfo.txt'

with open(input_file, 'r') as fasta_file, open(output_file, 'w') as output:
    for line in fasta_file:
        if line.startswith('>'):
            output.write(line[1:])  # Write header without '>'

#ctrl +z
#Then added in 1 next to each
########

conda activate mobmess #mobmess to calculate ANI between pairs
mobmess systems \
    --sequences /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input/lnuA_replicons_formatted.fasta \
    --complete /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mobmess/completeinfo.txt \
    --output /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mobmess/lnua-mobmess \
    --threads 8
conda deactivate


#run mars to use for plasmid maps
/home/asommer3/MARS/mars -i /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/input/lnuA_replicons_formatted.fasta \
-o /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mars/lnuA_refinedsequences_mars.fasta \
-a DNA -m 1


########tetK Plasmids#######

mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mobmess
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mars
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/plasmidfinder


#Added tetK_replicons_preformatted_noref.fasta to input subfolder. The fasta file has all rep proteins on (+) strand
conda activate abricate #abricate to doublecheck rep genes
abricate --db plasmidfinder /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input/tetK_replicons_preformatted_noref.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/plasmidfinder/tetK_plasmidfinder_results_nofref.tab
conda deactivate

#added refs to tetK_replicons_preformatted.fasta as reference. The accessions from the plasmid finder are actually not the closest sequences (checked via blast)


cd /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input
awk '/^>/ {if (NR>1) print ""; print $0; next} {printf "%s", $0} END {print ""}' tetK_replicons_preformatted.fasta > tetK_replicons_formatted.fasta 



conda activate abricate #abricate to doublecheck rep genes
abricate --db plasmidfinder /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input/tetK_replicons_formatted.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/plasmidfinder/tetK_plasmidfinder_results.tab
conda deactivate



####python####
python
input_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input/tetK_replicons_formatted.fasta'
output_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mobmess/completeinfo.txt'

with open(input_file, 'r') as fasta_file, open(output_file, 'w') as output:
    for line in fasta_file:
        if line.startswith('>'):
            output.write(line[1:])  # Write header without '>'

#ctrl +z
#Then added in 1 next to each
########

conda activate mobmess #mobmess to calculate ANI between pairs
mobmess systems \
    --sequences /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input/tetK_replicons_formatted.fasta \
    --complete /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mobmess/completeinfo.txt \
    --output /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mobmess/tetk-mobmess \
    --threads 8
conda deactivate


#run mars to use for plasmid maps
/home/asommer3/MARS/mars -i /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/input/tetK_replicons_preformatted.fasta \
-o /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/tetK/mars/tetK_refinedsequences_mars.fasta \
-a DNA -m 1



########str Plasmids#######

mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mobmess
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mars
mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/plasmidfinder


#Added str_replicons_preformatted_noref.fasta to input subfolder. The fasta file has all rep proteins on (+) strand
conda activate abricate #abricate to doublecheck rep genes
abricate --db plasmidfinder /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input/str_replicons_preformatted_noref.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/plasmidfinder/str_plasmidfinder_results_nofref.tab
conda deactivate

#added refs to str_replicons_preformatted.fasta as reference. 

cd /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input
awk '/^>/ {if (NR>1) print ""; print $0; next} {printf "%s", $0} END {print ""}' str_replicons_preformatted.fasta > str_replicons_formatted.fasta 



conda activate abricate #abricate to doublecheck rep genes
abricate --db plasmidfinder /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input/str_replicons_formatted.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/plasmidfinder/str_plasmidfinder_results.tab
conda deactivate



####python####
python
input_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input/str_replicons_formatted.fasta'
output_file = '/home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mobmess/completeinfo.txt'

with open(input_file, 'r') as fasta_file, open(output_file, 'w') as output:
    for line in fasta_file:
        if line.startswith('>'):
            output.write(line[1:])  # Write header without '>'

#ctrl +z
#Then added in 1 next to each
########

conda activate mobmess #mobmess to calculate ANI between pairs
mobmess systems \
    --sequences /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input/str_replicons_formatted.fasta \
    --complete /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mobmess/completeinfo.txt \
    --output /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mobmess/str-mobmess \
    --threads 8
conda deactivate


#run mars to use for plasmid maps
/home/asommer3/MARS/mars -i /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/input/str_replicons_preformatted.fasta \
-o /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/str/mars/str_refinedsequences_mars.fasta \
-a DNA -m 1



###MAFFT wasn't very informative

mkdir /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mafft
cd /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mafft
mafft --maxiterate 1000 --localpair  --thread 8 /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mars/lnuA_refinedsequences_mars.fasta > /home/asommer3/Research/stablefly_wgs/analysis/plasmidanalysis/lnuA/mafft/lnuA_refinedsequences_mafft.fasta

ssh suenlab@10.128.54.202 #enter password metaG@4455
screen -S Sommer_fasttree #Start a Screen called Sommer_fasttree


mkdir /media/GS_Data_6/Sommer/WGS_Analysis/plasmidanalysis
mkdir /media/GS_Data_6/Sommer/WGS_Analysis/plasmidanalysis/lnuA
cd /media/GS_Data_6/Sommer/WGS_Analysis/plasmidanalysis/lnuA
##added mafft file to the server
/home/suenlab/Software/FastTree -h

/home/suenlab/Software/FastTree -nt -log logfile.txt  lnuA_refinedsequences_mafft.fasta > lnuA_refinedsequences_MAF.newick



